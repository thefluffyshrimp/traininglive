define(["jquery","core/pubsub","core/str","core_message/message_drawer_events","core_message/message_drawer_view_contacts_section_contacts","core_message/message_drawer_view_contacts_section_requests"],function(a,b,c,d,e,f){var g={ACTION_SHOW_CONTACTS_SECTION:'[data-action="show-contacts-section"]',ACTION_SHOW_REQUESTS_SECTION:'[data-action="show-requests-section"]',CONTACT_REQUEST_COUNT:'[data-region="contact-request-count"]',CONTACTS_SECTION_CONTAINER:'[data-section="contacts"]',REQUESTS_SECTION_CONTAINER:'[data-section="requests"]'},h=function(a){return a.find(g.CONTACTS_SECTION_CONTAINER)},i=function(a){return a.find(g.REQUESTS_SECTION_CONTAINER)},j=function(a){return a.find(g.ACTION_SHOW_CONTACTS_SECTION)},k=function(a){return a.find(g.ACTION_SHOW_REQUESTS_SECTION)},l=function(a){return a.hasClass("active")},m=function(a){return function(){var b=a.find(g.CONTACT_REQUEST_COUNT),c=parseInt(b.text(),10);c=isNaN(c)?0:c-1,c<=0?b.addClass("hidden"):b.text(c)}},n=function(a){var c=h(a),j=i(a),k=a.find(g.ACTION_SHOW_CONTACTS_SECTION),l=a.find(g.ACTION_SHOW_REQUESTS_SECTION);k.on("show.bs.tab",function(){e.show(c)}),l.on("show.bs.tab",function(){f.show(j)}),b.subscribe(d.CONTACT_REQUEST_ACCEPTED,m(a)),b.subscribe(d.CONTACT_REQUEST_DECLINED,m(a))},o=function(b,c,d){c=a(c),c.attr("data-contacts-init")||(n(c),c.attr("data-contacts-init",!0));var g=h(c),m=i(c);if(d){var o=j(c),p=k(c);"requests"==d?(o.removeClass("active"),g.removeClass("show active"),p.addClass("active"),m.addClass("show active")):(p.removeClass("active"),m.removeClass("show active"),o.addClass("active"),g.addClass("show active"))}return l(g)?e.show(g):f.show(m),a.Deferred().resolve().promise()},p=function(){return c.get_string("messagedrawerviewcontacts","core_message")};return{show:o,description:p}});